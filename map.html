 <!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Tr√¢nsito Inteligente de POA | Mapa e Preven√ß√£o</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playwrite+DE+SAS:wght@100..400&family=Roboto:wght@300;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #0056b3; 
            --secondary-color: #1e90ff; 
            --background-color: #f4f4f4;
            --text-color: #333;
            --highlight-color: #ff8c00; 
            --safe-color: #28a745; 
            --red-alert: red;
        }
        /* Estilos base (mantidos do original para consist√™ncia) */
        body { background-color: var(--background-color); color: var(--text-color); font-family: 'Roboto', sans-serif; text-align: center; margin: 0; padding: 0; }
        .landing-container { width: 90%; max-width: 1100px; padding: 40px; margin: 50px auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); }
        h1 { font-family: 'Playwrite DE SAS', cursive; font-size: 3em; color: var(--primary-color); margin-bottom: 10px; }
        .slogan { font-size: 1.5em; color: #6c757d; margin-bottom: 40px; }
        .features { display: flex; justify-content: space-around; margin-bottom: 50px; flex-wrap: wrap; }
        .feature-item { flex-basis: 30%; padding: 20px 10px; border-radius: 10px; transition: transform 0.3s, box-shadow 0.3s; }
        .feature-item:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }
        .feature-item i { font-size: 2.5em; color: var(--secondary-color); margin-bottom: 10px; }
        .cta-button { display: inline-block; padding: 15px 30px; font-size: 1.2em; font-weight: bold; color: white; background-color: var(--highlight-color); border: none; border-radius: 8px; text-decoration: none; transition: background-color 0.3s, transform 0.1s; box-shadow: 0 4px 15px rgba(255, 140, 0, 0.4); }
        .cta-button:hover { background-color: #e67e22; transform: translateY(-2px); }
        .prevention-section { background-color: #e8f5e9; padding: 30px 20px; border-radius: 10px; margin-top: 30px; }
        .prevention-section h2 { color: var(--safe-color); font-size: 2em; margin-bottom: 25px; }
        .prevention-grid { display: flex; justify-content: space-around; gap: 20px; }
        .prevention-tip { flex-basis: 30%; }
        .prevention-tip i { font-size: 3em; color: var(--safe-color); margin-bottom: 10px; border: 3px solid var(--safe-color); border-radius: 50%; padding: 15px; }
        .prevention-tip h3 { color: var(--text-color); font-size: 1.2em; }
        .map-section-header { padding: 40px 0 20px; background-color: var(--primary-color); color: white; margin-top: 30px; }
        .map-section-header h2 { font-family: 'Playwrite DE SAS', sans-serif; font-size: 2.5em; margin: 0; }
        #map { height: 500px; width: 90%; margin: 20px auto; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); }
        #location-message { margin: 10px auto; color: #fff; font-weight: bold; }
        /* Bot√£o de Localiza√ß√£o Reposicionado para o centro do container do mapa */
        #locate-button { position: absolute; top: 120px; right: 6%; z-index: 1000; background-color: white; border: 2px solid #ccc; border-radius: 5px; padding: 8px; cursor: pointer; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); font-size: 1.2em; color: var(--primary-color); }
        
        /* √çcone de Acidente (Simula√ß√£o de Alerta) */
        .accident-icon { background-color: var(--red-alert); border-radius: 50%; border: 3px solid white; color: white; text-align: center; line-height: 24px; font-weight: bold; font-size: 16px; width: 24px; height: 24px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 0, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); } }
        
        /* Estilos do Popup */
        .news-status { font-weight: bold; color: var(--highlight-color); }
        .weather-status { font-weight: bold; color: var(--secondary-color); }
        .popup-info { line-height: 1.6; text-align: left; }

        /* Responsividade (Mantida do original) */
        @media (max-width: 768px) {
            h1 { font-size: 2em; }
            .landing-container { margin: 20px auto; padding: 20px; }
            .features, .prevention-grid { flex-direction: column; gap: 20px; }
            .feature-item, .prevention-tip { flex-basis: 100%; }
            .map-section-header h2 { font-size: 2em; }
            #locate-button { top: 75px; right: 5%; }
        }
    </style>
    
</head>
<body>
    
    <div class="landing-container">
        
        <header>
            <h1>Sistema de Monitoramento de Tr√¢nsito Inteligente de POA</h1>
            <p class="slogan">Navegue pela cidade com intelig√™ncia. Sua seguran√ßa em primeiro lugar.</p>
        </header>

        <a href="#map-anchor" class="cta-button">
            Ver Mapa em Tempo Real
        </a>
        
        <hr style="margin: 50px 0; border-color: #eee;">

        <div class="features">
            <div class="feature-item">
                <i class="fas fa-route"></i>
                <h3>Tr√¢nsito em Tempo Real</h3>
                <p>Veja o fluxo das principais vias e planeje sua rota com base na simula√ß√£o de congestionamentos.</p>
            </div>
            
            <div class="feature-item">
                <i class="fas fa-car-crash" style="color: red;"></i>
                <h3>Pontos Cr√≠ticos de Acidentes</h3>
                <p>Identifique cruzamentos de alto risco e acidentes atuais, incluindo cobertura de notici√°rios.</p>
            </div>
            
            <div class="feature-item">
                <i class="fas fa-cloud-sun"></i>
                <h3>Condi√ß√µes do Tempo</h3>
                <p>Previs√£o do tempo simulada para cada local, essencial para dirigir com seguran√ßa.</p>
            </div>
        </div>
        
        <hr style="margin: 50px 0; border-color: #eee;">

        <section class="prevention-section">
            <h2>Como Evitar Acidentes: Dicas Essenciais</h2>
            <div class="prevention-grid">
                
                <div class="prevention-tip">
                    <i class="fas fa-tachometer-alt"></i>
                    <h3>Respeite os Limites</h3>
                    <p>A velocidade √© a principal causa de acidentes graves. Adeque a velocidade √† condi√ß√£o da via e do tempo.</p>
                </div>
                
                <div class="prevention-tip">
                    <i class="fas fa-mobile-alt" style="color: var(--highlight-color);"></i>
                    <h3>Celular Fica no Bolso</h3>
                    <p>Mantenha o foco total na dire√ß√£o. O uso do celular triplica o risco de colis√£o e distra√ß√£o.</p>
                </div>
                
                <div class="prevention-tip">
                    <i class="fas fa-hand-holding-medical"></i>
                    <h3>Mantenha a Dist√¢ncia</h3>
                    <p>Use a regra dos dois segundos para manter uma dist√¢ncia segura do ve√≠culo √† frente, especialmente na chuva.</p>
                </div>
            </div>
        </section>
        
        <footer>
            <p style="font-size: 0.9em; color: #999; margin-top: 30px;">&copy; 2025 POA Smart Traffic. Todos os direitos reservados.</p>
        </footer>

    </div>
    
    <section id="map-anchor" class="map-section-header">
        <div class="container">
            <h2>Mapa Interativo em Tempo Real</h2>
            <p id="location-message">Buscando sua localiza√ß√£o. Por favor, autorize o acesso.</p>
        </div>
    </section>

    <div style="background-color: white; padding-bottom: 40px; position: relative;">
        <button id="locate-button" onclick="map.locate({setView: true, maxZoom: 16})">
            <i class="fas fa-location-crosshairs"></i>
        </button>

        <div id="map"></div>
        <p style="font-size: 0.8em; color: #666;">Dados de mapa base fornecidos por &copy; OpenStreetMap contributors. <span id="update-time">(Atualiza√ß√£o a cada 10s)</span></p>
    </div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
        // === VARI√ÅVEIS GLOBAIS E CONFIGURA√á√ÉO ===
        const portoAlegreCoords = [-30.0346, -51.2177]; 
        const locMessage = document.getElementById('location-message');
        const updateTimeDisplay = document.getElementById('update-time');
        
        var map = L.map('map').setView(portoAlegreCoords, 12);
        const riskMarkersLayer = L.layerGroup().addTo(map);
        let userLocationMarker = null; 

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        const AccidentIcon = L.divIcon({
            className: 'accident-icon',
            html: '!',
            iconSize: [24, 24],
            popupAnchor: [0, -12]
        });

        // Pontos de Risco Baseados em Dados Reais da EPTC/Not√≠cias de POA
        const pontosDeRiscoData = [
            { coords: [-30.0460, -51.1818], nome: "Ipiranga x Salvador Fran√ßa", detalhe: "Maior volume de acidentes de colis√£o no geral, ponto mais perigoso (2021/2022)." }, 
            { coords: [-30.0525, -51.2010], nome: "Ipiranga x Azenha", detalhe: "Alto √≠ndice de ocorr√™ncias, entre os tr√™s mais perigosos." }, 
            { coords: [-30.0385, -51.2260], nome: "Ipiranga x Borges de Medeiros", detalhe: "Ponto de grande fluxo e risco, entre os tr√™s mais perigosos." }, 
            { coords: [-30.0430, -51.1920], nome: "Ipiranga x Silva S√≥ / S√£o Manoel", detalhe: "Concentra√ß√£o de acidentes, 2¬∫ maior em ocorr√™ncias em 2017." }, 
            { coords: [-29.9880, -51.1390], nome: "Dona Margarida x Edu Chaves", detalhe: "Ponto cr√≠tico na Zona Norte, alto n√∫mero de colis√µes/atropelamentos." }, 
            { coords: [-30.0400, -51.2170], nome: "Av. Bento Gon√ßalves", detalhe: "Via com maior quantidade de acidentes fatais (2019-2023)." }, 
            { coords: [-30.0050, -51.1550], nome: "Av. Assis Brasil", detalhe: "Volume de tr√°fego enorme, segunda via em acidentes fatais." }, 
            { coords: [-30.0620, -51.1780], nome: "Av. Prot√°sio Alves", detalhe: "Via com alta acidentalidade e risco de atropelamento. (Simula√ß√£o de ponto)." }, 
            { coords: [-30.0500, -51.2250], nome: "Av. Padre Cacique", detalhe: "Hist√≥rico de acidentes, incluindo fatais (Simula√ß√£o de ponto)." }, 
            { coords: [-30.0150, -51.2290], nome: "Av. Farrapos x Sarmento Barata", detalhe: "Hist√≥rico de colis√µes/atropelamentos." }, 
            { coords: [-30.0300, -51.2100], nome: "T√∫nel da Concei√ß√£o / Entorno", detalhe: "Fluxo r√°pido e entrada no centro. (Simulado)" },
        ];

        // === FUN√á√ïES DE SIMULA√á√ÉO ===
        function simulateWeather() {
            const weatherOptions = [
                { status: "C√©u Limpo", icon: "‚òÄÔ∏è", color: "#1e90ff" },
                { status: "Nublado", icon: "‚òÅÔ∏è", color: "#6c757d" },
                { status: "Chuva Fraca", icon: "üåßÔ∏è", color: "#28a745" },
                { status: "Chuva Forte (Risco)", icon: "‚õàÔ∏è", color: "red" },
                { status: "Neblina", icon: "üå´Ô∏è", color: "#6c757d" }
            ];
            const randomIndex = Math.floor(Math.random() * weatherOptions.length);
            return weatherOptions[randomIndex];
        }

        function simulateNews() {
            const newsOptions = ["GZH Tr√¢nsito (AO VIVO)", "Record RS", "Correio do Povo", "N√£o Reportado no momento"];
            return newsOptions[Math.floor(Math.random() * newsOptions.length)];
        }

        // === FUN√á√ÉO PRINCIPAL DE ATUALIZA√á√ÉO DO MAPA ===
        function updateMapData() {
            riskMarkersLayer.clearLayers(); 
            updateTimeDisplay.textContent = `Atualizado: ${new Date().toLocaleTimeString('pt-BR')}`;
            
            // SIMULA√á√ÉO: Seleciona um n√∫mero aleat√≥rio de pontos ativos
            const minActive = 3;
            const maxActive = Math.min(pontosDeRiscoData.length, 8); 
            const activeAccidentsCount = Math.floor(Math.random() * (maxActive - minActive + 1)) + minActive; 
            
            const shuffledPoints = pontosDeRiscoData.sort(() => 0.5 - Math.random());
            const activePoints = shuffledPoints.slice(0, activeAccidentsCount);

            activePoints.forEach(ponto => {
                const weather = simulateWeather();
                const noticiario = simulateNews();
                
                const noticiarioHtml = noticiario === "N√£o Reportado no momento" ? `<span style="color: grey;">${noticiario}</span>` : `<span class="news-status">üì∫ ${noticiario}</span>`;
                const tempoHtml = `<span class="weather-status" style="color: ${weather.color};">${weather.icon} ${weather.status}</span>`;

                L.marker(ponto.coords, {icon: AccidentIcon})
                    .bindPopup(`
                        <div class="popup-info">
                            <strong>üö® ${ponto.nome}</strong><br>
                            ${ponto.detalhe}<br><hr style="margin: 5px 0;">
                            Tempo: ${tempoHtml}<br>
                            Reportagem: ${noticiarioHtml}
                        </div>
                    `)
                    .addTo(riskMarkersLayer);
            });
            map.invalidateSize(); 
        }
        
        // === GEOLOCALIZA√á√ÉO DO USU√ÅRIO ===

        function onLocationFound(e) {
            locMessage.textContent = "‚úÖ Sua localiza√ß√£o foi encontrada!";
            locMessage.style.color = "#fff"; 
            
            if (userLocationMarker) { userLocationMarker.remove(); }
            
            userLocationMarker = L.layerGroup([
                L.circleMarker(e.latlng, { radius: 8, color: '#007bff', fillColor: '#007bff', fillOpacity: 1 }).bindPopup("<strong>Voc√™ est√° aqui.</strong>").openPopup(),
                L.circle(e.latlng, e.accuracy / 2, { color: '#007bff', fillColor: '#007bff', fillOpacity: 0.1, weight: 1 })
            ]).addTo(map);

            if (map.getZoom() < 13) { map.setView(e.latlng, 16); }
        }

        function onLocationError(e) {
            locMessage.textContent = `‚ùå Erro ao localizar: ${e.message}. Exibindo centro de POA.`;
            locMessage.style.color = "#ffdd00"; 
        }

        // === INICIALIZA√á√ÉO E EVENT LISTENERS ===

        map.on('locationfound', onLocationFound);
        map.on('locationerror', onLocationError);

        map.locate({setView: false, watch: true, enableHighAccuracy: true});
        
        updateMapData();
        setInterval(updateMapData, 10000); 

        window.addEventListener('load', function() {
            map.invalidateSize();
        });
    </script>
</body>
</html>
